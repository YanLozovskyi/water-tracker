import{t as C,g as E,h as T,m as ee,i as te,k as $,l as ne,r as x,j as e,D as me,o as xe,p as fe,q as ge,v as je,w as pe,x as ye,y as L,z as De,A as U,E as V,F as se,G as ae,J as Me,K as we,M as ke,N as z,Q as re,R as Te,S as Se,U as oe,V as D,X as $e,Y as be,Z as Ce,_,$ as ve,a0 as Ne,a1 as We,a2 as He,a3 as Oe,a4 as Ie,a5 as ie,s as S,a6 as le,a7 as ce,a8 as Be,a9 as Z,aa as G,ab as K,ac as Le,ad as Pe,ae as Re,af as Ve,ag as Ue,ah as Fe,ai as Ye,aj as Ae,ak as Ee,al as ze,am as X,an as _e,ao as Ze,ap as Ge,aq as Ke,ar as Xe,as as qe,at as Je,au as Qe,av as et,aw as tt,ax as nt,ay as st,az as at,aA as rt,aB as ot,aC as it,aD as lt,aE as ct,aF as dt,n as A}from"./index-645be7d7.js";import{S as ut}from"./Section-401a607b.js";import{i as ht,a as mt,b as xt,c as ft,d as gt,e as jt}from"./bubbleTablet@2x-6c947164.js";function de(s,t){const n=C(s);if(isNaN(t))return E(s,NaN);if(!t)return n;const a=n.getDate(),r=E(s,n.getTime());r.setMonth(n.getMonth()+t+1,0);const o=r.getDate();return a>=o?r:(n.setFullYear(r.getFullYear(),r.getMonth(),a),n)}function q(s){const t=C(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function pt(s,t){const n=C(s.start),a=C(s.end);let r=+n>+a;const o=r?+n:+a,i=r?a:n;i.setHours(0,0,0,0);let c=(t==null?void 0:t.step)??1;if(!c)return[];c<0&&(c=-c,r=!r);const l=[];for(;+i<=o;)l.push(C(i)),i.setDate(i.getDate()+c),i.setHours(0,0,0,0);return r?l.reverse():l}function J(s){const t=C(s);return t.setDate(1),t.setHours(0,0,0,0),t}function Q(s,t){const n=C(s);if(isNaN(n.getTime()))throw new RangeError("Invalid time value");const a=(t==null?void 0:t.format)??"extended",r=(t==null?void 0:t.representation)??"complete";let o="",i="";const c=a==="extended"?"-":"",l=a==="extended"?":":"";if(r!=="time"){const d=T(n.getDate(),2),j=T(n.getMonth()+1,2);o=`${T(n.getFullYear(),4)}${c}${j}${c}${d}`}if(r!=="date"){const d=n.getTimezoneOffset();if(d!==0){const k=Math.abs(d),b=T(Math.floor(k/60),2),m=T(k%60,2);i=`${d<0?"+":"-"}${b}:${m}`}else i="Z";const j=T(n.getHours(),2),f=T(n.getMinutes(),2),u=T(n.getSeconds(),2),h=o===""?"":"T",M=[j,f,u].join(l);o=`${o}${h}${M}${i}`}return o}function Y(s,t){const n=(t==null?void 0:t.additionalDigits)??2,a=wt(s);let r;if(a.date){const l=kt(a.date,n);r=Tt(l.restDateString,l.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const o=r.getTime();let i=0,c;if(a.time&&(i=St(a.time),isNaN(i)))return new Date(NaN);if(a.timezone){if(c=$t(a.timezone),isNaN(c))return new Date(NaN)}else{const l=new Date(o+i),d=new Date(0);return d.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),d.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),d}return new Date(o+i+c)}const P={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},yt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Dt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Mt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wt(s){const t={},n=s.split(P.dateTimeDelimiter);let a;if(n.length>2)return t;if(/:/.test(n[0])?a=n[0]:(t.date=n[0],a=n[1],P.timeZoneDelimiter.test(t.date)&&(t.date=s.split(P.timeZoneDelimiter)[0],a=s.substr(t.date.length,s.length))),a){const r=P.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function kt(s,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=s.match(n);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,o=a[2]?parseInt(a[2]):null;return{year:o===null?r:o*100,restDateString:s.slice((a[1]||a[2]).length)}}function Tt(s,t){if(t===null)return new Date(NaN);const n=s.match(yt);if(!n)return new Date(NaN);const a=!!n[4],r=H(n[1]),o=H(n[2])-1,i=H(n[3]),c=H(n[4]),l=H(n[5])-1;if(a)return Wt(t,c,l)?bt(t,c,l):new Date(NaN);{const d=new Date(0);return!vt(t,o,i)||!Nt(t,r)?new Date(NaN):(d.setUTCFullYear(t,o,Math.max(r,i)),d)}}function H(s){return s?parseInt(s):1}function St(s){const t=s.match(Dt);if(!t)return NaN;const n=F(t[1]),a=F(t[2]),r=F(t[3]);return Ht(n,a,r)?n*ee+a*te+r*1e3:NaN}function F(s){return s&&parseFloat(s.replace(",","."))||0}function $t(s){if(s==="Z")return 0;const t=s.match(Mt);if(!t)return 0;const n=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Ot(a,r)?n*(a*ee+r*te):NaN}function bt(s,t,n){const a=new Date(0);a.setUTCFullYear(s,0,4);const r=a.getUTCDay()||7,o=(t-1)*7+n+1-r;return a.setUTCDate(a.getUTCDate()+o),a}const Ct=[31,null,31,30,31,30,31,31,30,31,30,31];function ue(s){return s%400===0||s%4===0&&s%100!==0}function vt(s,t,n){return t>=0&&t<=11&&n>=1&&n<=(Ct[t]||(ue(s)?29:28))}function Nt(s,t){return t>=1&&t<=(ue(s)?366:365)}function Wt(s,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Ht(s,t,n){return s===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&s>=0&&s<25}function Ot(s,t){return t>=0&&t<=59}function It(s,t){return de(s,-t)}const Bt=()=>{const{waterRate:s}=$(ne),[t,n]=x.useState(!1),a=()=>{n(!0)},r=()=>{n(!1)},o=(s/1e3).toFixed(1)+" L";return e.jsxs(me,{children:[e.jsxs(xe,{children:[e.jsx("h2",{children:"My daily norma: "}),e.jsxs("div",{children:[e.jsx("p",{children:o}),e.jsx("button",{onClick:a,children:"Edit"})]}),t&&e.jsx(fe,{onClose:r})]}),e.jsx(ge,{})]})},Lt=({stats:s,position:t,onShow:n})=>{const{date:a,drinkCount:r,waterVolumePercentage:o}=s,i=x.useRef(null),{waterRate:c}=$(ne);x.useEffect(()=>{if(!i.current)return;const{top:j,left:f,width:u}=t,h=i.current,M=h.offsetWidth;if(window.innerWidth<=320)h.style.width="100%",h.style.left="0",h.style.top=`${j-h.offsetHeight}px`,h.style.transform="translateX(0)";else{const b=f,m=window.innerWidth-f-u;b>M?h.style.left=`${f-M}px`:m>M?h.style.left=`${f+u}px`:(h.style.left="50%",h.style.transform="translateX(-50%)"),h.style.top=`${j-h.offsetHeight}px`}},[t]);const l=(c/1e3).toFixed(1)+" L",d=a?je(a,"d, MMMM"):"";return e.jsx(pe,{ref:i,style:{visibility:n?"visible":"hidden"},children:e.jsxs(ye,{children:[e.jsx(L,{children:e.jsx(De,{children:d})}),e.jsxs(L,{children:["Daily norma:",e.jsx(U,{children:l})]}),e.jsxs(L,{children:["Fulfillment of the daily norm:",e.jsxs(U,{children:[Math.round(o),"%"]})]}),e.jsxs(L,{children:["How many servings of water:",e.jsx(U,{children:r})]})]})})},Pt=({onClose:s,recordId:t})=>{const n=V(),{isLoading:a}=$(se),r=()=>{n(Te(t)).then(o=>{o.error||s()})};return e.jsx(ae,{onClose:s,title:"Delete Entry",children:e.jsxs(Me,{children:[e.jsx(we,{children:"Are you sure you want to delete the entry?"}),e.jsxs(ke,{children:[e.jsxs(z,{onClick:r,children:["Delete ",a&&e.jsx(re,{})]}),e.jsx(z,{onClick:s,children:"Cancel"})]})]})})},Rt=()=>{const s=V(),t=$(Se),[n,a]=x.useState(new Date),[r,o]=x.useState(!1),[i,c]=x.useState({top:0,left:0,width:0}),[l,d]=x.useState(null),[j,f]=x.useState(!1),u=x.useRef({}),h=$(oe),M=D(J(n),"yyyy-MM-dd"),k=D(q(n),"yyyy-MM-dd");x.useEffect(()=>{s($e({startDate:M,endDate:k}))},[s,k,h,M]);const b=()=>{a(It(n,1))},m=()=>{n<new Date&&a(de(n,1))},w=pt({start:J(n),end:q(n)}),O=t.reduce((g,y)=>(g[y.date]=y,g),{}),I=g=>{const y=D(g,"yyyy-MM-dd"),p=O[y];(l==null?void 0:l.date)===y&&r?(o(!1),d(null)):(d({date:y,waterVolumeSum:p?p.waterVolumeSum:0,drinkCount:p?p.drinkCount:0,waterVolumePercentage:p?p.waterVolumePercentage:0}),o(!0));const B=u.current[g];if(B){const W=B.getBoundingClientRect();c({top:W.top+window.scrollY,left:W.left,width:W.width})}},v=()=>{o(!1),d(null)};return x.useEffect(()=>{const g=y=>{r&&Object.values(u.current).every(N=>N&&!N.contains(y.target))&&v()};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[r,l]),e.jsxs("div",{children:[e.jsxs(be,{children:[e.jsx("h2",{children:"Month"}),e.jsxs(Ce,{onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[e.jsx(_,{onClick:b,children:"<"}),e.jsx("span",{children:D(n,"MMMM")}),j&&e.jsx(ve,{children:D(n,"yyyy").split("-")[0]}),e.jsx(_,{onClick:m,disabled:n>=new Date,children:">"})]})]}),e.jsxs(Ne,{children:[w.map(g=>{const y=D(g,"yyyy-MM-dd"),p=O[y],N=p?p.waterVolumePercentage:0,B=p&&p.waterVolumePercentage<100;return e.jsx("div",{children:e.jsxs(We,{children:[e.jsx(He,{ref:W=>u.current[g]=W,onClick:()=>I(g),isHighlighted:B,children:D(g,"d")}),e.jsxs("span",{children:[Math.round(N),"%"]})]})},y)}),r&&l&&e.jsx(Lt,{stats:l,position:i,onClose:v,onShow:r})]})]})},he=({initialAmount:s,initialTime:t,isEditing:n,onClose:a,existingRecordId:r})=>{const[o,i]=x.useState(s||0),[c,l]=x.useState(n&&t?D(new Date(t),"HH:mm"):D(new Date,"HH:mm")),d=V(),{isLoading:j}=$(se),f=()=>i(m=>m+50),u=()=>i(m=>m>0?m-50:0),h=m=>{let w=m.target.value;w.startsWith("0")&&w.length>1&&(w=w.substring(1)),i(w)},M=()=>{const w=`${Q(new Date,{representation:"date"})}T${c}`,O=Q(Y(w)),I={waterVolume:o,date:O};n?d(Ae({_id:r,...I})).then(v=>{v.error||a()}):d(Ee(I)).then(v=>{v.error||a()})},k=n?"Edit the entered amount of water":"Add water",b=n&&t?D(Y(t),"hh:mm aa"):"";return e.jsx(ae,{onClose:a,title:k,children:e.jsxs(Oe,{children:[n&&e.jsxs(Ie,{children:[e.jsx(ie,{children:e.jsx("use",{href:`${S}#icon-glass`})}),e.jsx(le,{children:s?`${s} ml`:"No notes yet"}),e.jsx(ce,{children:t?`${b}`:""})]}),e.jsx("h3",{children:n?"Correct entered data:":"Choose a value:"}),e.jsxs(Be,{children:[e.jsx(Z,{children:"Amount of water:"}),e.jsxs("div",{children:[e.jsx(G,{onClick:u,children:e.jsx(K,{children:e.jsx("use",{href:`${S}#icon-decrement-outline`})})}),e.jsxs(Le,{children:[e.jsx(Pe,{type:"number",value:o,onChange:h,onBlur:()=>i(m=>m||s||0)}),e.jsx("span",{children:"ml"})]}),e.jsx(G,{onClick:f,children:e.jsx(K,{children:e.jsx("use",{href:`${S}#icon-increment`})})})]})]}),e.jsxs(Re,{children:[e.jsx(Z,{children:"Recording time:"}),e.jsx(Ve,{type:"time",value:c,onChange:m=>l(m.target.value),step:"300"})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Enter the value of the water used:"}),e.jsx(Ue,{type:"number",value:o,onChange:h,onBlur:()=>i(m=>m||s||"")})]}),e.jsxs(Fe,{children:[e.jsxs("span",{children:[o,"ml"]}),e.jsxs(Ye,{onClick:M,children:["Save ",j&&e.jsx(re,{})]})]})]})})},R={glass:`${S}#icon-glass`,change:`${S}#icon-change`,delete:`${S}#icon-delete`,add:`${S}#icon-increment`},Vt=()=>{const s=V(),[t,n]=x.useState(!1),[a,r]=x.useState(null),[o,i]=x.useState(!1),{dailyWaterList:c}=$(ze);x.useEffect(()=>{s(X())},[s]);const l=()=>{r(null),n(!0)},d=u=>{r(u),i(!0)},j=u=>{r(u),n(!0)},f=()=>{s(X())};return e.jsxs(_e,{children:[e.jsx(Ze,{children:"Today"}),e.jsxs(Ge,{children:[c==null?void 0:c.map(u=>e.jsxs(Ke,{children:[e.jsxs(Xe,{children:[e.jsx(ie,{children:e.jsx("use",{href:R.glass})}),e.jsxs(le,{children:[u.waterVolume," ml"]}),e.jsx(ce,{children:D(Y(u.date),"hh:mm a")})]}),e.jsxs(qe,{children:[e.jsx(Je,{onClick:()=>j(u),children:e.jsx("svg",{children:e.jsx("use",{href:R.change})})}),e.jsx(Qe,{onClick:()=>d(u),children:e.jsx("svg",{children:e.jsx("use",{href:R.delete})})})]})]},u._id)),e.jsx("li",{children:e.jsxs(et,{onClick:l,children:[e.jsx("svg",{children:e.jsx("use",{href:R.add})}),"Add Water"]})})]}),o&&e.jsx(Pt,{onClose:()=>i(!1),recordId:a==null?void 0:a._id}),t&&e.jsx(he,{initialAmount:a==null?void 0:a.waterVolume,initialTime:a==null?void 0:a.date,isEditing:a!==null,existingRecordId:a==null?void 0:a._id,onClose:()=>n(!1),onUpdate:f})]})},Ut=()=>{const[s,t]=x.useState(!1),n=$(oe),a=()=>({left:`calc(${Math.min(100,Math.max(0,n))}% + 4px)`}),r=()=>({backgroundSize:`${n}%`}),o=n>0&&n<100;return e.jsxs(tt,{children:[e.jsxs(nt,{children:[e.jsx(st,{children:"Today"}),e.jsx(at,{type:"range",maxValue:100,minValue:0,value:n,readOnly:!0,style:r(),"aria-label":"Water range"}),e.jsxs(rt,{children:[e.jsx(ot,{children:"0%"}),o&&e.jsx(it,{id:"waterMark",style:a(),children:`${n}%`}),e.jsx(lt,{children:"100%"})]})]}),e.jsxs(ct,{onClick:()=>t(!0),children:[e.jsx(dt,{children:e.jsx("use",{href:`${S}#icon-increment-outline`})}),"Add Water"]}),s&&e.jsx(he,{onClose:()=>t(!1)})]})},Ft=A(ut)`
  background-position: center center;
  padding-top: 24px;
  padding-bottom: 24px;
  background-image: -webkit-image-set(
    url(${ht}) 1x,
    url(${mt}) 2x
  );
  background-size: contain;
  background-repeat: no-repeat;
  width: 100%;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    background-image: -webkit-image-set(
      url(${xt}) 1x,
      url(${ft}) 2x
    );
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    background-image: -webkit-image-set(
      url(${gt}) 1x,
      url(${jt}) 2x
    );
  }
`,Yt=A.div`
  padding: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    display: flex;
    flex-direction: row;
  }
`,At=A.div`
  padding: 24px 8px;
  box-shadow: 0px 4px 14px 0px rgba(64, 123, 255, 0.3);
  background: ${s=>s.theme.color.secondaryWhite};
  max-width: 280px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    padding: 32px 24px;
    max-width: 704px;
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    max-width: 592px;
    flex-direction: row;
  }
`,Zt=()=>e.jsx(Ft,{children:e.jsxs(Yt,{children:[e.jsxs("div",{children:[e.jsx(Bt,{}),e.jsx(Ut,{})]}),e.jsxs(At,{children:[e.jsx(Vt,{}),e.jsx(Rt,{})]})]})});export{Zt as default};
