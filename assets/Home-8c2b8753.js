import{t as k,g as _,h as $,m as se,i as ae,k as v,l as re,r as m,j as e,D as ge,o as je,p as pe,q as ye,v as De,w as Me,x as we,y as L,z as ke,A as Y,E as V,F as oe,G as ie,J as Te,K as Se,M as $e,N as Z,Q as le,R as be,S as ve,U as ce,V as M,X as Ce,Y as Ne,Z as We,_ as G,$ as He,a0 as Oe,a1 as Ie,a2 as Be,a3 as Le,a4 as Pe,a5 as de,s as b,a6 as ue,a7 as he,a8 as Re,a9 as K,aa as X,ab as q,ac as Ve,ad as Fe,ae as Ye,af as Ue,ag as Ae,ah as Ee,ai as ze,aj as _e,ak as Ze,al as Ge,am as J,an as Ke,ao as Xe,ap as qe,aq as Je,ar as Qe,as as et,at as tt,au as nt,av as st,aw as at,ax as rt,ay as ot,az as it,aA as lt,aB as ct,aC as dt,aD as ut,aE as ht,aF as mt,n as E}from"./index-c620d8a3.js";import{S as xt}from"./Section-1e125bb3.js";import{i as ft,a as gt,b as jt,c as pt,d as yt,e as Dt}from"./bubbleTablet@2x-6c947164.js";function me(s,t){const n=k(s);if(isNaN(t))return _(s,NaN);if(!t)return n;const a=n.getDate(),r=_(s,n.getTime());r.setMonth(n.getMonth()+t+1,0);const i=r.getDate();return a>=i?r:(n.setFullYear(r.getFullYear(),r.getMonth(),a),n)}function Q(s){const t=k(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Mt(s,t){const n=k(s.start),a=k(s.end);let r=+n>+a;const i=r?+n:+a,o=r?a:n;o.setHours(0,0,0,0);let l=(t==null?void 0:t.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(k(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return r?c.reverse():c}function ee(s){const t=k(s);return t.setDate(1),t.setHours(0,0,0,0),t}function te(s,t){const n=k(s);if(isNaN(n.getTime()))throw new RangeError("Invalid time value");const a=(t==null?void 0:t.format)??"extended",r=(t==null?void 0:t.representation)??"complete";let i="",o="";const l=a==="extended"?"-":"",c=a==="extended"?":":"";if(r!=="time"){const d=$(n.getDate(),2),x=$(n.getMonth()+1,2);i=`${$(n.getFullYear(),4)}${l}${x}${l}${d}`}if(r!=="date"){const d=n.getTimezoneOffset();if(d!==0){const C=Math.abs(d),T=$(Math.floor(C/60),2),S=$(C%60,2);o=`${d<0?"+":"-"}${T}:${S}`}else o="Z";const x=$(n.getHours(),2),j=$(n.getMinutes(),2),f=$(n.getSeconds(),2),u=i===""?"":"T",p=[x,j,f].join(c);i=`${i}${u}${p}${o}`}return i}function ne(s,t){const n=k(s),a=k(t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function A(s,t){const n=(t==null?void 0:t.additionalDigits)??2,a=St(s);let r;if(a.date){const c=$t(a.date,n);r=bt(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const i=r.getTime();let o=0,l;if(a.time&&(o=vt(a.time),isNaN(o)))return new Date(NaN);if(a.timezone){if(l=Ct(a.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const P={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},wt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,kt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Tt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function St(s){const t={},n=s.split(P.dateTimeDelimiter);let a;if(n.length>2)return t;if(/:/.test(n[0])?a=n[0]:(t.date=n[0],a=n[1],P.timeZoneDelimiter.test(t.date)&&(t.date=s.split(P.timeZoneDelimiter)[0],a=s.substr(t.date.length,s.length))),a){const r=P.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function $t(s,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=s.match(n);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:i===null?r:i*100,restDateString:s.slice((a[1]||a[2]).length)}}function bt(s,t){if(t===null)return new Date(NaN);const n=s.match(wt);if(!n)return new Date(NaN);const a=!!n[4],r=I(n[1]),i=I(n[2])-1,o=I(n[3]),l=I(n[4]),c=I(n[5])-1;if(a)return It(t,l,c)?Nt(t,l,c):new Date(NaN);{const d=new Date(0);return!Ht(t,i,o)||!Ot(t,r)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(r,o)),d)}}function I(s){return s?parseInt(s):1}function vt(s){const t=s.match(kt);if(!t)return NaN;const n=U(t[1]),a=U(t[2]),r=U(t[3]);return Bt(n,a,r)?n*se+a*ae+r*1e3:NaN}function U(s){return s&&parseFloat(s.replace(",","."))||0}function Ct(s){if(s==="Z")return 0;const t=s.match(Tt);if(!t)return 0;const n=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Lt(a,r)?n*(a*se+r*ae):NaN}function Nt(s,t,n){const a=new Date(0);a.setUTCFullYear(s,0,4);const r=a.getUTCDay()||7,i=(t-1)*7+n+1-r;return a.setUTCDate(a.getUTCDate()+i),a}const Wt=[31,null,31,30,31,30,31,31,30,31,30,31];function xe(s){return s%400===0||s%4===0&&s%100!==0}function Ht(s,t,n){return t>=0&&t<=11&&n>=1&&n<=(Wt[t]||(xe(s)?29:28))}function Ot(s,t){return t>=1&&t<=(xe(s)?366:365)}function It(s,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Bt(s,t,n){return s===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&s>=0&&s<25}function Lt(s,t){return t>=0&&t<=59}function Pt(s,t){return me(s,-t)}const Rt=()=>{const{waterRate:s}=v(re),[t,n]=m.useState(!1),a=()=>{n(!0)},r=()=>{n(!1)},i=(s/1e3).toFixed(1)+" L";return e.jsxs(ge,{children:[e.jsxs(je,{children:[e.jsx("h2",{children:"My daily norma: "}),e.jsxs("div",{children:[e.jsx("p",{children:i}),e.jsx("button",{onClick:a,children:"Edit"})]}),e.jsx(pe,{onClose:r,onShow:t})]}),e.jsx(ye,{})]})},Vt=({stats:s,position:t,onShow:n})=>{const{date:a,drinkCount:r,waterVolumePercentage:i}=s,o=m.useRef(null),{waterRate:l}=v(re);m.useEffect(()=>{if(!o.current)return;const{top:x,left:j,width:f}=t,u=o.current,p=u.offsetWidth;if(window.innerWidth<=320)u.style.width="100%",u.style.left="0",u.style.top=`${x-u.offsetHeight}px`,u.style.transform="translateX(0)";else{const T=j,S=window.innerWidth-j-f;T>p?u.style.left=`${j-p}px`:S>p?u.style.left=`${j+f}px`:(u.style.left="50%",u.style.transform="translateX(-50%)"),u.style.top=`${x-u.offsetHeight}px`}},[t]);const c=(l/1e3).toFixed(1)+" L",d=a?De(a,"d, MMMM"):"";return e.jsx(Me,{ref:o,style:{visibility:n?"visible":"hidden"},children:e.jsxs(we,{children:[e.jsx(L,{children:e.jsx(ke,{children:d})}),e.jsxs(L,{children:["Daily norma:",e.jsx(Y,{children:c})]}),e.jsxs(L,{children:["Fulfillment of the daily norm:",e.jsxs(Y,{children:[Math.round(i),"%"]})]}),e.jsxs(L,{children:["How many servings of water:",e.jsx(Y,{children:r})]})]})})},Ft=({onClose:s,onShow:t,recordId:n})=>{const a=V(),{isLoading:r}=v(oe),i=()=>{a(be(n)).then(o=>{o.error||s()})};return e.jsx(ie,{onClose:s,onShow:t,title:"Delete Entry",children:e.jsxs(Te,{children:[e.jsx(Se,{children:"Are you sure you want to delete the entry?"}),e.jsxs($e,{children:[e.jsxs(Z,{onClick:i,children:["Delete ",r&&e.jsx(le,{})]}),e.jsx(Z,{onClick:s,children:"Cancel"})]})]})})},Yt=()=>{const s=V(),t=v(ve),[n,a]=m.useState(new Date),[r,i]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState({top:0,left:0,width:0}),[x,j]=m.useState(null),[f,u]=m.useState(!1),p=m.useRef({}),C=v(ce),T=M(ee(n),"yyyy-MM-dd"),S=M(Q(n),"yyyy-MM-dd");m.useEffect(()=>{s(Ce({startDate:T,endDate:S}))},[s,S,C,T]);const g=()=>{const h=Pt(n,1);a(h),ne(h,new Date)?i(null):i("prev")},w=()=>{if(n<new Date){const h=me(n,1);a(h),ne(h,new Date)?i(null):i("next")}},F=Mt({start:ee(n),end:Q(n)}),N=t.reduce((h,D)=>(h[D.date]=D,h),{}),W=h=>{const D=M(h,"yyyy-MM-dd"),y=N[D];(x==null?void 0:x.date)===D&&o?(l(!1),j(null)):(j({date:D,waterVolumeSum:y?y.waterVolumeSum:0,drinkCount:y?y.drinkCount:0,waterVolumePercentage:y?y.waterVolumePercentage:0}),l(!0));const B=p.current[h];if(B){const O=B.getBoundingClientRect();d({top:O.top+window.scrollY,left:O.left,width:O.width})}},z=()=>{l(!1),j(null)};return m.useEffect(()=>{const h=D=>{o&&Object.values(p.current).every(H=>H&&!H.contains(D.target))&&z()};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[o,x]),e.jsxs("div",{children:[e.jsxs(Ne,{children:[e.jsx("h2",{children:"Month"}),e.jsxs(We,{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[e.jsx(G,{onClick:g,active:r==="next",children:"<"}),e.jsx("span",{children:M(n,"MMMM")}),f&&e.jsx(He,{children:M(n,"yyyy").split("-")[0]}),e.jsx(G,{onClick:w,disabled:n>=new Date,active:r==="prev",children:">"})]})]}),e.jsxs(Oe,{children:[F.map(h=>{const D=M(h,"yyyy-MM-dd"),y=N[D],H=y?y.waterVolumePercentage:0,B=y&&y.waterVolumePercentage<100;return e.jsx("div",{children:e.jsxs(Ie,{children:[e.jsx(Be,{ref:O=>p.current[h]=O,onClick:()=>W(h),isHighlighted:B,children:M(h,"d")}),e.jsxs("span",{children:[Math.round(H),"%"]})]})},D)}),o&&x&&e.jsx(Vt,{stats:x,position:c,onClose:z,onShow:o})]})]})},fe=({initialAmount:s,initialTime:t,isEditing:n,onClose:a,onShow:r,existingRecordId:i})=>{const[o,l]=m.useState(s||0),[c,d]=m.useState(n&&t?M(new Date(t),"HH:mm"):M(new Date,"HH:mm")),x=V(),{isLoading:j}=v(oe),f=()=>l(g=>g+50),u=()=>l(g=>g>0?g-50:0),p=g=>{let w=g.target.value;w.startsWith("0")&&w.length>1&&(w=w.substring(1)),l(w)},C=()=>{const w=`${te(new Date,{representation:"date"})}T${c}`,F=te(A(w)),N={waterVolume:o,date:F};n?x(_e({_id:i,...N})).then(W=>{W.error||a()}):x(Ze(N)).then(W=>{W.error||a()})},T=n?"Edit the entered amount of water":"Add water",S=n&&t?M(A(t),"hh:mm aa"):"";return e.jsx(ie,{onClose:a,onShow:r,title:T,children:e.jsxs(Le,{children:[n&&e.jsxs(Pe,{children:[e.jsx(de,{children:e.jsx("use",{href:`${b}#icon-glass`})}),e.jsx(ue,{children:s?`${s} ml`:"No notes yet"}),e.jsx(he,{children:t?`${S}`:""})]}),e.jsx("h3",{children:n?"Correct entered data:":"Choose a value:"}),e.jsxs(Re,{children:[e.jsx(K,{children:"Amount of water:"}),e.jsxs("div",{children:[e.jsx(X,{onClick:u,children:e.jsx(q,{children:e.jsx("use",{href:`${b}#icon-decrement-outline`})})}),e.jsxs(Ve,{children:[e.jsx(Fe,{type:"number",value:o,onChange:p,onBlur:()=>l(g=>g||s||0)}),e.jsx("span",{children:"ml"})]}),e.jsx(X,{onClick:f,children:e.jsx(q,{children:e.jsx("use",{href:`${b}#icon-increment`})})})]})]}),e.jsxs(Ye,{children:[e.jsx(K,{children:"Recording time:"}),e.jsx(Ue,{type:"time",value:c,onChange:g=>d(g.target.value),step:"300"})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Enter the value of the water used:"}),e.jsx(Ae,{type:"number",value:o,onChange:p,onBlur:()=>l(g=>g||s||"")})]}),e.jsxs(Ee,{children:[e.jsxs("span",{children:[o,"ml"]}),e.jsxs(ze,{onClick:C,children:["Save ",j&&e.jsx(le,{})]})]})]})})},R={glass:`${b}#icon-glass`,change:`${b}#icon-change`,delete:`${b}#icon-delete`,add:`${b}#icon-increment`},Ut=()=>{const s=V(),[t,n]=m.useState(!1),[a,r]=m.useState(null),[i,o]=m.useState(!1),{dailyWaterList:l}=v(Ge);m.useEffect(()=>{s(J())},[s]);const c=()=>{r(null),n(!0)},d=f=>{r(f),o(!0)},x=f=>{r(f),n(!0)},j=()=>{s(J())};return e.jsxs(Ke,{children:[e.jsx(Xe,{children:"Today"}),e.jsxs(qe,{children:[l==null?void 0:l.map(f=>e.jsxs(Je,{children:[e.jsxs(Qe,{children:[e.jsx(de,{children:e.jsx("use",{href:R.glass})}),e.jsxs(ue,{children:[f.waterVolume," ml"]}),e.jsx(he,{children:M(A(f.date),"hh:mm a")})]}),e.jsxs(et,{children:[e.jsx(tt,{onClick:()=>x(f),children:e.jsx("svg",{children:e.jsx("use",{href:R.change})})}),e.jsx(nt,{onClick:()=>d(f),children:e.jsx("svg",{children:e.jsx("use",{href:R.delete})})})]})]},f._id)),e.jsx("li",{children:e.jsxs(st,{onClick:c,children:[e.jsx("svg",{children:e.jsx("use",{href:R.add})}),"Add Water"]})})]}),e.jsx(Ft,{onClose:()=>o(!1),onShow:i,recordId:a==null?void 0:a._id}),e.jsx(fe,{initialAmount:a==null?void 0:a.waterVolume,initialTime:a==null?void 0:a.date,isEditing:a!==null,existingRecordId:a==null?void 0:a._id,onClose:()=>n(!1),onShow:t,onUpdate:j})]})},At=()=>{const[s,t]=m.useState(!1),n=v(ce),a=()=>({left:`calc(${Math.min(100,Math.max(0,n))}% + 4px)`}),r=()=>({backgroundSize:`${n}%`}),i=n>0&&n<100;return e.jsxs(at,{children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Today"}),e.jsx(it,{type:"range",maxValue:100,minValue:0,value:n,readOnly:!0,style:r(),"aria-label":"Water range"}),e.jsxs(lt,{children:[e.jsx(ct,{children:"0%"}),i&&e.jsx(dt,{id:"waterMark",style:a(),children:`${n}%`}),e.jsx(ut,{children:"100%"})]})]}),e.jsxs(ht,{onClick:()=>t(!0),children:[e.jsx(mt,{children:e.jsx("use",{href:`${b}#icon-increment-outline`})}),"Add Water"]}),e.jsx(fe,{onClose:()=>t(!1),onShow:s})]})},Et=E(xt)`
  background-position: center center;
  padding-top: 24px;
  padding-bottom: 24px;
  background-image: -webkit-image-set(
    url(${ft}) 1x,
    url(${gt}) 2x
  );
  background-size: contain;
  background-repeat: no-repeat;
  width: 100%;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    background-image: -webkit-image-set(
      url(${jt}) 1x,
      url(${pt}) 2x
    );
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    background-image: -webkit-image-set(
      url(${yt}) 1x,
      url(${Dt}) 2x
    );
  }
`,zt=E.div`
  padding: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    display: flex;
    flex-direction: row;
  }
`,_t=E.div`
  padding: 24px 8px;
  box-shadow: 0px 4px 14px 0px rgba(64, 123, 255, 0.3);
  background: ${s=>s.theme.color.secondaryWhite};
  max-width: 280px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    padding: 32px 24px;
    max-width: 704px;
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    max-width: 592px;
    flex-direction: row;
  }
`,Xt=()=>e.jsx(Et,{children:e.jsxs(zt,{children:[e.jsxs("div",{children:[e.jsx(Rt,{}),e.jsx(At,{})]}),e.jsxs(_t,{children:[e.jsx(Ut,{}),e.jsx(Yt,{})]})]})});export{Xt as default};
