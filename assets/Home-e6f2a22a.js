import{t as S,l as Y,m as Q,o as ee,p as T,q as te,r as u,j as e,D as me,v as fe,w as ge,x as pe,y as je,z as ye,A as De,E as O,F as Me,G as R,g as L,J as ne,K as se,M as we,N as ke,Q as Se,R as E,S as ae,U as Te,V as Ce,X as re,Y as D,Z as be,_ as ve,$ as Ne,a0 as z,a1 as $e,a2 as We,a3 as He,a4 as Ie,a5 as Oe,a6 as Be,a7 as oe,s as k,a8 as ie,a9 as le,aa as Pe,ab as _,ac as G,ad as Z,ae as Le,af as Re,ag as Ve,ah as Ae,ai as Fe,aj as Ue,ak as Ye,al as Ee,am as ze,an as _e,ao as K,ap as Ge,aq as Ze,ar as Ke,as as Xe,at as qe,au as Je,av as Qe,aw as et,ax as tt,ay as nt,az as st,aA as at,aB as rt,aC as ot,aD as it,aE as lt,aF as ct,aG as dt,aH as ut,n as A}from"./index-fb23f69d.js";import{S as ht}from"./Section-7500bc8c.js";import{i as xt,a as mt,b as ft,c as gt,d as pt,e as jt}from"./bubbleTablet@2x-6c947164.js";function ce(n,t){const s=S(n);if(isNaN(t))return Y(n,NaN);if(!t)return s;const a=s.getDate(),r=Y(n,s.getTime());r.setMonth(s.getMonth()+t+1,0);const i=r.getDate();return a>=i?r:(s.setFullYear(r.getFullYear(),r.getMonth(),a),s)}function X(n){const t=S(n),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}function yt(n,t){const s=S(n.start),a=S(n.end);let r=+s>+a;const i=r?+s:+a,o=r?a:s;o.setHours(0,0,0,0);let l=(t==null?void 0:t.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(S(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return r?c.reverse():c}function q(n){const t=S(n);return t.setDate(1),t.setHours(0,0,0,0),t}function J(n,t){const s=S(n),a=S(t);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}function de(n,t){const s=(t==null?void 0:t.additionalDigits)??2,a=kt(n);let r;if(a.date){const c=St(a.date,s);r=Tt(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const i=r.getTime();let o=0,l;if(a.time&&(o=Ct(a.time),isNaN(o)))return new Date(NaN);if(a.timezone){if(l=bt(a.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),m=new Date(0);return m.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),m.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),m}return new Date(i+o+l)}const B={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Dt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Mt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,wt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function kt(n){const t={},s=n.split(B.dateTimeDelimiter);let a;if(s.length>2)return t;if(/:/.test(s[0])?a=s[0]:(t.date=s[0],a=s[1],B.timeZoneDelimiter.test(t.date)&&(t.date=n.split(B.timeZoneDelimiter)[0],a=n.substr(t.date.length,n.length))),a){const r=B.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function St(n,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=n.match(s);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:i===null?r:i*100,restDateString:n.slice((a[1]||a[2]).length)}}function Tt(n,t){if(t===null)return new Date(NaN);const s=n.match(Dt);if(!s)return new Date(NaN);const a=!!s[4],r=W(s[1]),i=W(s[2])-1,o=W(s[3]),l=W(s[4]),c=W(s[5])-1;if(a)return Ht(t,l,c)?vt(t,l,c):new Date(NaN);{const m=new Date(0);return!$t(t,i,o)||!Wt(t,r)?new Date(NaN):(m.setUTCFullYear(t,i,Math.max(r,o)),m)}}function W(n){return n?parseInt(n):1}function Ct(n){const t=n.match(Mt);if(!t)return NaN;const s=V(t[1]),a=V(t[2]),r=V(t[3]);return It(s,a,r)?s*Q+a*ee+r*1e3:NaN}function V(n){return n&&parseFloat(n.replace(",","."))||0}function bt(n){if(n==="Z")return 0;const t=n.match(wt);if(!t)return 0;const s=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Ot(a,r)?s*(a*Q+r*ee):NaN}function vt(n,t,s){const a=new Date(0);a.setUTCFullYear(n,0,4);const r=a.getUTCDay()||7,i=(t-1)*7+s+1-r;return a.setUTCDate(a.getUTCDate()+i),a}const Nt=[31,null,31,30,31,30,31,31,30,31,30,31];function ue(n){return n%400===0||n%4===0&&n%100!==0}function $t(n,t,s){return t>=0&&t<=11&&s>=1&&s<=(Nt[t]||(ue(n)?29:28))}function Wt(n,t){return t>=1&&t<=(ue(n)?366:365)}function Ht(n,t,s){return t>=1&&t<=53&&s>=0&&s<=6}function It(n,t,s){return n===24?t===0&&s===0:s>=0&&s<60&&t>=0&&t<60&&n>=0&&n<25}function Ot(n,t){return t>=0&&t<=59}function Bt(n,t){return ce(n,-t)}const Pt=()=>{const{waterRate:n}=T(te),[t,s]=u.useState(!1),a=()=>{s(!0)},r=()=>{s(!1)},i=(n/1e3).toFixed(1)+" L";return e.jsxs(me,{children:[e.jsxs(fe,{children:[e.jsx("h2",{children:"My daily norma: "}),e.jsxs("div",{children:[e.jsx("p",{children:i}),e.jsx("button",{onClick:a,children:"Edit"})]}),e.jsx(ge,{onClose:r,onShow:t})]}),e.jsx(pe,{})]})},Lt=({stats:n,position:t,onShow:s})=>{const{date:a,drinkCount:r,waterVolumePercentage:i}=n,o=u.useRef(null),{waterRate:l}=T(te);u.useEffect(()=>{if(!o.current)return;const{top:f,left:p,width:x}=t,h=o.current,w=h.offsetWidth;if(window.innerWidth<=320)h.style.width="100%",h.style.left="0",h.style.top=`${f-h.offsetHeight}px`,h.style.transform="translateX(0)";else{const C=p,b=window.innerWidth-p-x;C>w?h.style.left=`${p-w}px`:b>w?h.style.left=`${p+x}px`:(h.style.left="50%",h.style.transform="translateX(-50%)"),h.style.top=`${f-h.offsetHeight}px`}},[t]);const c=(l/1e3).toFixed(1)+" L",m=a?je(a,"d, MMMM"):"";return e.jsx(ye,{ref:o,style:{visibility:s?"visible":"hidden"},children:e.jsxs(De,{children:[e.jsx(O,{children:e.jsx(Me,{children:m})}),e.jsxs(O,{children:["Daily norma:",e.jsx(R,{children:c})]}),e.jsxs(O,{children:["Fulfillment of the daily norm:",e.jsxs(R,{children:[Math.round(i),"%"]})]}),e.jsxs(O,{children:["How many servings of water:",e.jsx(R,{children:r})]})]})})},Rt=({onClose:n,onShow:t,recordId:s})=>{const a=L(),{isLoading:r}=T(ne),i="32px 24px",o=()=>{a(Te(s)).then(l=>{l.error||n()})};return e.jsx(se,{onClose:n,onShow:t,stylesPadding:i,title:"Delete Entry",children:e.jsxs(we,{children:[e.jsx(ke,{children:"Are you sure you want to delete the entry?"}),e.jsxs(Se,{children:[e.jsxs(E,{onClick:o,children:["Delete ",r&&e.jsx(ae,{})]}),e.jsx(E,{onClick:n,children:"Cancel"})]})]})})},Vt=()=>{const n=L(),t=T(Ce),[s,a]=u.useState(new Date),[r,i]=u.useState(null),[o,l]=u.useState(!1),[c,m]=u.useState({top:0,left:0,width:0}),[f,p]=u.useState(null),[x,h]=u.useState(!1),w=u.useRef({}),H=T(re),C=D(q(s),"yyyy-MM-dd"),b=D(X(s),"yyyy-MM-dd");u.useEffect(()=>{n(be({startDate:C,endDate:b}))},[n,b,H,C]);const g=()=>{const d=Bt(s,1);a(d),J(d,new Date)?i(null):i("prev")},M=()=>{if(s<new Date){const d=ce(s,1);a(d),J(d,new Date)?i(null):i("next")}},v=yt({start:q(s),end:X(s)}),F=t.reduce((d,y)=>(d[y.date]=y,d),{}),xe=d=>{const y=D(d,"yyyy-MM-dd"),j=F[y];(f==null?void 0:f.date)===y&&o?(l(!1),p(null)):(p({date:y,waterVolumeSum:j?j.waterVolumeSum:0,drinkCount:j?j.drinkCount:0,waterVolumePercentage:j?j.waterVolumePercentage:0}),l(!0));const I=w.current[d];if(I){const $=I.getBoundingClientRect();m({top:$.top+window.scrollY,left:$.left,width:$.width})}},U=()=>{l(!1),p(null)};return u.useEffect(()=>{const d=y=>{o&&Object.values(w.current).every(N=>N&&!N.contains(y.target))&&U()};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[o,f]),e.jsxs("div",{children:[e.jsxs(ve,{children:[e.jsx("h2",{children:"Month"}),e.jsxs(Ne,{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[e.jsx(z,{onClick:g,active:r==="next",children:"<"}),e.jsx("span",{children:D(s,"MMMM")}),x&&e.jsx($e,{children:D(s,"yyyy").split("-")[0]}),e.jsx(z,{onClick:M,disabled:s>=new Date,active:r==="prev",children:">"})]})]}),e.jsxs(We,{children:[v.map(d=>{const y=D(d,"yyyy-MM-dd"),j=F[y],N=j?j.waterVolumePercentage:0,I=j&&j.waterVolumePercentage<100;return e.jsx("div",{children:e.jsxs(He,{children:[e.jsx(Ie,{ref:$=>w.current[d]=$,onClick:()=>xe(d),isHighlighted:I,children:D(d,"d")}),e.jsxs("span",{children:[Math.round(N),"%"]})]})},y)}),o&&f&&e.jsx(Lt,{stats:f,position:c,onClose:U,onShow:o})]})]})},he=({initialAmount:n,initialTime:t,isEditing:s,onClose:a,onShow:r,existingRecordId:i})=>{const[o,l]=u.useState(n||0),[c,m]=u.useState(s&&t?D(new Date(t),"HH:mm"):D(new Date,"HH:mm")),f=L(),{isLoading:p}=T(ne),x=()=>l(g=>g+50),h=()=>l(g=>g>0?g-50:0),w=g=>{let M=g.target.value;M.startsWith("0")&&M.length>1&&(M=M.substring(1)),l(M)},H=()=>{const g=new Date().toISOString(),M={waterVolume:o,date:g};s?f(Ee({_id:i,...M})).then(v=>{v.error||a()}):f(ze(M)).then(v=>{v.error||a()})},C=s?"Edit the entered amount of water":"Add water",b=s&&t?D(de(t),"hh:mm aa"):"";return e.jsx(se,{onClose:a,onShow:r,title:C,children:e.jsxs(Oe,{children:[s&&e.jsxs(Be,{children:[e.jsx(oe,{children:e.jsx("use",{href:`${k}#icon-glass`})}),e.jsx(ie,{children:n?`${n} ml`:"No notes yet"}),e.jsx(le,{children:t?`${b}`:""})]}),e.jsx("h3",{children:s?"Correct entered data:":"Choose a value:"}),e.jsxs(Pe,{children:[e.jsx(_,{children:"Amount of water:"}),e.jsxs("div",{children:[e.jsx(G,{onClick:h,children:e.jsx(Z,{children:e.jsx("use",{href:`${k}#icon-decrement-outline`})})}),e.jsx(Le,{children:e.jsxs(Re,{children:[o,"ml"]})}),e.jsx(G,{onClick:x,children:e.jsx(Z,{children:e.jsx("use",{href:`${k}#icon-increment`})})})]})]}),e.jsxs(Ve,{children:[e.jsx(_,{children:"Recording time:"}),e.jsx(Ae,{type:"time",value:c,onChange:g=>m(g.target.value),step:"300"})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Enter the value of the water used:"}),e.jsx(Fe,{type:"number",value:o,onChange:w,onBlur:()=>l(g=>g||n||"")})]}),e.jsxs(Ue,{children:[e.jsxs("span",{children:[o,"ml"]}),e.jsxs(Ye,{onClick:H,children:["Save ",p&&e.jsx(ae,{})]})]})]})})},P={glass:`${k}#icon-glass`,change:`${k}#icon-change`,delete:`${k}#icon-delete`,add:`${k}#icon-increment`},At=()=>{const n=L(),[t,s]=u.useState(!1),[a,r]=u.useState(null),[i,o]=u.useState(!1),{dailyWaterList:l}=T(_e);u.useEffect(()=>{n(K())},[n]);const c=()=>{r(null),s(!0)},m=x=>{r(x),o(!0)},f=x=>{r(x),s(!0)},p=()=>{n(K())};return e.jsxs(Ge,{children:[e.jsx(Ze,{children:"Today"}),e.jsxs(Ke,{children:[l==null?void 0:l.map(x=>e.jsxs(Xe,{children:[e.jsxs(qe,{children:[e.jsx(oe,{children:e.jsx("use",{href:P.glass})}),e.jsxs(ie,{children:[x.waterVolume," ml"]}),e.jsx(le,{children:D(de(x.date),"hh:mm a")})]}),e.jsxs(Je,{children:[e.jsx(Qe,{onClick:()=>f(x),children:e.jsx("svg",{children:e.jsx("use",{href:P.change})})}),e.jsx(et,{onClick:()=>m(x),children:e.jsx("svg",{children:e.jsx("use",{href:P.delete})})})]})]},x._id)),e.jsx("li",{children:e.jsxs(tt,{onClick:c,children:[e.jsx("svg",{children:e.jsx("use",{href:P.add})}),"Add Water"]})})]}),e.jsx(Rt,{onClose:()=>o(!1),onShow:i,recordId:a==null?void 0:a._id}),e.jsx(he,{initialAmount:a==null?void 0:a.waterVolume,initialTime:a==null?void 0:a.date,isEditing:a!==null,existingRecordId:a==null?void 0:a._id,onClose:()=>s(!1),onShow:t,onUpdate:p})]})},Ft=()=>{const[n,t]=u.useState(!1),s=T(re),a=()=>({left:`calc(${Math.min(100,Math.max(0,s))}% + 4px)`}),r=()=>({backgroundSize:`${s}%`}),i=s>0&&s<100;return e.jsxs(nt,{children:[e.jsxs(st,{children:[e.jsx(at,{children:"Today"}),e.jsx(rt,{type:"range",maxValue:100,minValue:0,value:s,readOnly:!0,style:r(),"aria-label":"Water range"}),e.jsxs(ot,{children:[e.jsx(it,{children:"0%"}),i&&e.jsx(lt,{id:"waterMark",style:a(),children:`${s}%`}),e.jsx(ct,{children:"100%"})]})]}),e.jsxs(dt,{onClick:()=>t(!0),children:[e.jsx(ut,{children:e.jsx("use",{href:`${k}#icon-increment-outline`})}),"Add Water"]}),e.jsx(he,{onClose:()=>t(!1),onShow:n})]})},Ut=A(ht)`
  background-position: center center;
  padding-top: 24px;
  padding-bottom: 24px;
  background-image: -webkit-image-set(
    url(${xt}) 1x,
    url(${mt}) 2x
  );
  background-size: contain;
  background-repeat: no-repeat;
  width: 100%;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.tablet}) {
    background-image: -webkit-image-set(
      url(${ft}) 1x,
      url(${gt}) 2x
    );
  }

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    background-image: -webkit-image-set(
      url(${pt}) 1x,
      url(${jt}) 2x
    );
  }
`,Yt=A.div`
  padding: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    display: flex;
    flex-direction: row;
  }
`,Et=A.div`
  padding: 24px 8px;
  box-shadow: 0px 4px 14px 0px rgba(64, 123, 255, 0.3);
  background: ${n=>n.theme.color.secondaryWhite};
  max-width: 280px;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.tablet}) {
    padding: 32px 24px;
    max-width: 704px;
  }

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    max-width: 592px;
    flex-direction: row;
  }
`,Zt=()=>e.jsx(Ut,{children:e.jsxs(Yt,{children:[e.jsxs("div",{children:[e.jsx(Pt,{}),e.jsx(Ft,{})]}),e.jsxs(Et,{children:[e.jsx(At,{}),e.jsx(Vt,{})]})]})});export{Zt as default};
