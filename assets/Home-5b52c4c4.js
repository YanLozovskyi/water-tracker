import{t as k,g as z,h as S,m as ne,i as se,k as b,l as ae,r as x,j as e,D as ge,o as je,p as pe,q as ye,v as De,w as Me,x as we,y as B,z as ke,A as F,E as R,F as re,G as oe,J as Te,K as Se,M as $e,N as _,Q as ie,R as be,S as ve,U as le,V as M,X as Ce,Y as Ne,Z as We,_ as Z,$ as He,a0 as Oe,a1 as Ie,a2 as Be,a3 as Le,a4 as Pe,a5 as ce,s as $,a6 as de,a7 as ue,a8 as Re,a9 as G,aa as K,ab as X,ac as Ve,ad as Fe,ae as Ye,af as Ue,ag as Ae,ah as Ee,ai as ze,aj as _e,ak as Ze,al as Ge,am as q,an as Ke,ao as Xe,ap as qe,aq as Je,ar as Qe,as as et,at as tt,au as nt,av as st,aw as at,ax as rt,ay as ot,az as it,aA as lt,aB as ct,aC as dt,aD as ut,aE as ht,aF as mt,n as A}from"./index-8a0878a9.js";import{S as xt}from"./Section-7f7b0ad6.js";import{i as ft,a as gt,b as jt,c as pt,d as yt,e as Dt}from"./bubbleTablet@2x-6c947164.js";function he(s,t){const n=k(s);if(isNaN(t))return z(s,NaN);if(!t)return n;const a=n.getDate(),r=z(s,n.getTime());r.setMonth(n.getMonth()+t+1,0);const o=r.getDate();return a>=o?r:(n.setFullYear(r.getFullYear(),r.getMonth(),a),n)}function J(s){const t=k(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Mt(s,t){const n=k(s.start),a=k(s.end);let r=+n>+a;const o=r?+n:+a,i=r?a:n;i.setHours(0,0,0,0);let l=(t==null?void 0:t.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+i<=o;)c.push(k(i)),i.setDate(i.getDate()+l),i.setHours(0,0,0,0);return r?c.reverse():c}function Q(s){const t=k(s);return t.setDate(1),t.setHours(0,0,0,0),t}function ee(s,t){const n=k(s);if(isNaN(n.getTime()))throw new RangeError("Invalid time value");const a=(t==null?void 0:t.format)??"extended",r=(t==null?void 0:t.representation)??"complete";let o="",i="";const l=a==="extended"?"-":"",c=a==="extended"?":":"";if(r!=="time"){const d=S(n.getDate(),2),g=S(n.getMonth()+1,2);o=`${S(n.getFullYear(),4)}${l}${g}${l}${d}`}if(r!=="date"){const d=n.getTimezoneOffset();if(d!==0){const v=Math.abs(d),T=S(Math.floor(v/60),2),h=S(v%60,2);i=`${d<0?"+":"-"}${T}:${h}`}else i="Z";const g=S(n.getHours(),2),j=S(n.getMinutes(),2),f=S(n.getSeconds(),2),u=o===""?"":"T",y=[g,j,f].join(c);o=`${o}${u}${y}${i}`}return o}function te(s,t){const n=k(s),a=k(t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function U(s,t){const n=(t==null?void 0:t.additionalDigits)??2,a=St(s);let r;if(a.date){const c=$t(a.date,n);r=bt(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const o=r.getTime();let i=0,l;if(a.time&&(i=vt(a.time),isNaN(i)))return new Date(NaN);if(a.timezone){if(l=Ct(a.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(o+i),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(o+i+l)}const L={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},wt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,kt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Tt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function St(s){const t={},n=s.split(L.dateTimeDelimiter);let a;if(n.length>2)return t;if(/:/.test(n[0])?a=n[0]:(t.date=n[0],a=n[1],L.timeZoneDelimiter.test(t.date)&&(t.date=s.split(L.timeZoneDelimiter)[0],a=s.substr(t.date.length,s.length))),a){const r=L.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function $t(s,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=s.match(n);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,o=a[2]?parseInt(a[2]):null;return{year:o===null?r:o*100,restDateString:s.slice((a[1]||a[2]).length)}}function bt(s,t){if(t===null)return new Date(NaN);const n=s.match(wt);if(!n)return new Date(NaN);const a=!!n[4],r=H(n[1]),o=H(n[2])-1,i=H(n[3]),l=H(n[4]),c=H(n[5])-1;if(a)return It(t,l,c)?Nt(t,l,c):new Date(NaN);{const d=new Date(0);return!Ht(t,o,i)||!Ot(t,r)?new Date(NaN):(d.setUTCFullYear(t,o,Math.max(r,i)),d)}}function H(s){return s?parseInt(s):1}function vt(s){const t=s.match(kt);if(!t)return NaN;const n=Y(t[1]),a=Y(t[2]),r=Y(t[3]);return Bt(n,a,r)?n*ne+a*se+r*1e3:NaN}function Y(s){return s&&parseFloat(s.replace(",","."))||0}function Ct(s){if(s==="Z")return 0;const t=s.match(Tt);if(!t)return 0;const n=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Lt(a,r)?n*(a*ne+r*se):NaN}function Nt(s,t,n){const a=new Date(0);a.setUTCFullYear(s,0,4);const r=a.getUTCDay()||7,o=(t-1)*7+n+1-r;return a.setUTCDate(a.getUTCDate()+o),a}const Wt=[31,null,31,30,31,30,31,31,30,31,30,31];function me(s){return s%400===0||s%4===0&&s%100!==0}function Ht(s,t,n){return t>=0&&t<=11&&n>=1&&n<=(Wt[t]||(me(s)?29:28))}function Ot(s,t){return t>=1&&t<=(me(s)?366:365)}function It(s,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Bt(s,t,n){return s===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&s>=0&&s<25}function Lt(s,t){return t>=0&&t<=59}function Pt(s,t){return he(s,-t)}const Rt=()=>{const{waterRate:s}=b(ae),[t,n]=x.useState(!1),a=()=>{n(!0)},r=()=>{n(!1)},o=(s/1e3).toFixed(1)+" L";return e.jsxs(ge,{children:[e.jsxs(je,{children:[e.jsx("h2",{children:"My daily norma: "}),e.jsxs("div",{children:[e.jsx("p",{children:o}),e.jsx("button",{onClick:a,children:"Edit"})]}),t&&e.jsx(pe,{onClose:r})]}),e.jsx(ye,{})]})},Vt=({stats:s,position:t,onShow:n})=>{const{date:a,drinkCount:r,waterVolumePercentage:o}=s,i=x.useRef(null),{waterRate:l}=b(ae);x.useEffect(()=>{if(!i.current)return;const{top:g,left:j,width:f}=t,u=i.current,y=u.offsetWidth;if(window.innerWidth<=320)u.style.width="100%",u.style.left="0",u.style.top=`${g-u.offsetHeight}px`,u.style.transform="translateX(0)";else{const T=j,h=window.innerWidth-j-f;T>y?u.style.left=`${j-y}px`:h>y?u.style.left=`${j+f}px`:(u.style.left="50%",u.style.transform="translateX(-50%)"),u.style.top=`${g-u.offsetHeight}px`}},[t]);const c=(l/1e3).toFixed(1)+" L",d=a?De(a,"d, MMMM"):"";return e.jsx(Me,{ref:i,style:{visibility:n?"visible":"hidden"},children:e.jsxs(we,{children:[e.jsx(B,{children:e.jsx(ke,{children:d})}),e.jsxs(B,{children:["Daily norma:",e.jsx(F,{children:c})]}),e.jsxs(B,{children:["Fulfillment of the daily norm:",e.jsxs(F,{children:[Math.round(o),"%"]})]}),e.jsxs(B,{children:["How many servings of water:",e.jsx(F,{children:r})]})]})})},Ft=({onClose:s,recordId:t})=>{const n=R(),{isLoading:a}=b(re),r=()=>{n(be(t)).then(o=>{o.error||s()})};return e.jsx(oe,{onClose:s,title:"Delete Entry",children:e.jsxs(Te,{children:[e.jsx(Se,{children:"Are you sure you want to delete the entry?"}),e.jsxs($e,{children:[e.jsxs(_,{onClick:r,children:["Delete ",a&&e.jsx(ie,{})]}),e.jsx(_,{onClick:s,children:"Cancel"})]})]})})},Yt=()=>{const s=R(),t=b(ve),[n,a]=x.useState(new Date),[r,o]=x.useState(null),[i,l]=x.useState(!1),[c,d]=x.useState({top:0,left:0,width:0}),[g,j]=x.useState(null),[f,u]=x.useState(!1),y=x.useRef({}),v=b(le),T=M(Q(n),"yyyy-MM-dd"),h=M(J(n),"yyyy-MM-dd");x.useEffect(()=>{s(Ce({startDate:T,endDate:h}))},[s,h,v,T]);const w=()=>{const m=Pt(n,1);a(m),te(m,new Date)?o(null):o("prev")},V=()=>{if(n<new Date){const m=he(n,1);a(m),te(m,new Date)?o(null):o("next")}},O=Mt({start:Q(n),end:J(n)}),C=t.reduce((m,D)=>(m[D.date]=D,m),{}),fe=m=>{const D=M(m,"yyyy-MM-dd"),p=C[D];(g==null?void 0:g.date)===D&&i?(l(!1),j(null)):(j({date:D,waterVolumeSum:p?p.waterVolumeSum:0,drinkCount:p?p.drinkCount:0,waterVolumePercentage:p?p.waterVolumePercentage:0}),l(!0));const I=y.current[m];if(I){const W=I.getBoundingClientRect();d({top:W.top+window.scrollY,left:W.left,width:W.width})}},E=()=>{l(!1),j(null)};return x.useEffect(()=>{const m=D=>{i&&Object.values(y.current).every(N=>N&&!N.contains(D.target))&&E()};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[i,g]),e.jsxs("div",{children:[e.jsxs(Ne,{children:[e.jsx("h2",{children:"Month"}),e.jsxs(We,{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[e.jsx(Z,{onClick:w,active:r==="next",children:"<"}),e.jsx("span",{children:M(n,"MMMM")}),f&&e.jsx(He,{children:M(n,"yyyy").split("-")[0]}),e.jsx(Z,{onClick:V,disabled:n>=new Date,active:r==="prev",children:">"})]})]}),e.jsxs(Oe,{children:[O.map(m=>{const D=M(m,"yyyy-MM-dd"),p=C[D],N=p?p.waterVolumePercentage:0,I=p&&p.waterVolumePercentage<100;return e.jsx("div",{children:e.jsxs(Ie,{children:[e.jsx(Be,{ref:W=>y.current[m]=W,onClick:()=>fe(m),isHighlighted:I,children:M(m,"d")}),e.jsxs("span",{children:[Math.round(N),"%"]})]})},D)}),i&&g&&e.jsx(Vt,{stats:g,position:c,onClose:E,onShow:i})]})]})},xe=({initialAmount:s,initialTime:t,isEditing:n,onClose:a,existingRecordId:r})=>{const[o,i]=x.useState(s||0),[l,c]=x.useState(n&&t?M(new Date(t),"HH:mm"):M(new Date,"HH:mm")),d=R(),{isLoading:g}=b(re),j=()=>i(h=>h+50),f=()=>i(h=>h>0?h-50:0),u=h=>{let w=h.target.value;w.startsWith("0")&&w.length>1&&(w=w.substring(1)),i(w)},y=()=>{const w=`${ee(new Date,{representation:"date"})}T${l}`,V=ee(U(w)),O={waterVolume:o,date:V};n?d(_e({_id:r,...O})).then(C=>{C.error||a()}):d(Ze(O)).then(C=>{C.error||a()})},v=n?"Edit the entered amount of water":"Add water",T=n&&t?M(U(t),"hh:mm aa"):"";return e.jsx(oe,{onClose:a,title:v,children:e.jsxs(Le,{children:[n&&e.jsxs(Pe,{children:[e.jsx(ce,{children:e.jsx("use",{href:`${$}#icon-glass`})}),e.jsx(de,{children:s?`${s} ml`:"No notes yet"}),e.jsx(ue,{children:t?`${T}`:""})]}),e.jsx("h3",{children:n?"Correct entered data:":"Choose a value:"}),e.jsxs(Re,{children:[e.jsx(G,{children:"Amount of water:"}),e.jsxs("div",{children:[e.jsx(K,{onClick:f,children:e.jsx(X,{children:e.jsx("use",{href:`${$}#icon-decrement-outline`})})}),e.jsxs(Ve,{children:[e.jsx(Fe,{type:"number",value:o,onChange:u,onBlur:()=>i(h=>h||s||0)}),e.jsx("span",{children:"ml"})]}),e.jsx(K,{onClick:j,children:e.jsx(X,{children:e.jsx("use",{href:`${$}#icon-increment`})})})]})]}),e.jsxs(Ye,{children:[e.jsx(G,{children:"Recording time:"}),e.jsx(Ue,{type:"time",value:l,onChange:h=>c(h.target.value),step:"300"})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Enter the value of the water used:"}),e.jsx(Ae,{type:"number",value:o,onChange:u,onBlur:()=>i(h=>h||s||"")})]}),e.jsxs(Ee,{children:[e.jsxs("span",{children:[o,"ml"]}),e.jsxs(ze,{onClick:y,children:["Save ",g&&e.jsx(ie,{})]})]})]})})},P={glass:`${$}#icon-glass`,change:`${$}#icon-change`,delete:`${$}#icon-delete`,add:`${$}#icon-increment`},Ut=()=>{const s=R(),[t,n]=x.useState(!1),[a,r]=x.useState(null),[o,i]=x.useState(!1),{dailyWaterList:l}=b(Ge);x.useEffect(()=>{s(q())},[s]);const c=()=>{r(null),n(!0)},d=f=>{r(f),i(!0)},g=f=>{r(f),n(!0)},j=()=>{s(q())};return e.jsxs(Ke,{children:[e.jsx(Xe,{children:"Today"}),e.jsxs(qe,{children:[l==null?void 0:l.map(f=>e.jsxs(Je,{children:[e.jsxs(Qe,{children:[e.jsx(ce,{children:e.jsx("use",{href:P.glass})}),e.jsxs(de,{children:[f.waterVolume," ml"]}),e.jsx(ue,{children:M(U(f.date),"hh:mm a")})]}),e.jsxs(et,{children:[e.jsx(tt,{onClick:()=>g(f),children:e.jsx("svg",{children:e.jsx("use",{href:P.change})})}),e.jsx(nt,{onClick:()=>d(f),children:e.jsx("svg",{children:e.jsx("use",{href:P.delete})})})]})]},f._id)),e.jsx("li",{children:e.jsxs(st,{onClick:c,children:[e.jsx("svg",{children:e.jsx("use",{href:P.add})}),"Add Water"]})})]}),o&&e.jsx(Ft,{onClose:()=>i(!1),recordId:a==null?void 0:a._id}),t&&e.jsx(xe,{initialAmount:a==null?void 0:a.waterVolume,initialTime:a==null?void 0:a.date,isEditing:a!==null,existingRecordId:a==null?void 0:a._id,onClose:()=>n(!1),onUpdate:j})]})},At=()=>{const[s,t]=x.useState(!1),n=b(le),a=()=>({left:`calc(${Math.min(100,Math.max(0,n))}% + 4px)`}),r=()=>({backgroundSize:`${n}%`}),o=n>0&&n<100;return e.jsxs(at,{children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Today"}),e.jsx(it,{type:"range",maxValue:100,minValue:0,value:n,readOnly:!0,style:r(),"aria-label":"Water range"}),e.jsxs(lt,{children:[e.jsx(ct,{children:"0%"}),o&&e.jsx(dt,{id:"waterMark",style:a(),children:`${n}%`}),e.jsx(ut,{children:"100%"})]})]}),e.jsxs(ht,{onClick:()=>t(!0),children:[e.jsx(mt,{children:e.jsx("use",{href:`${$}#icon-increment-outline`})}),"Add Water"]}),s&&e.jsx(xe,{onClose:()=>t(!1)})]})},Et=A(xt)`
  background-position: center center;
  padding-top: 24px;
  padding-bottom: 24px;
  background-image: -webkit-image-set(
    url(${ft}) 1x,
    url(${gt}) 2x
  );
  background-size: contain;
  background-repeat: no-repeat;
  width: 100%;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    background-image: -webkit-image-set(
      url(${jt}) 1x,
      url(${pt}) 2x
    );
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    background-image: -webkit-image-set(
      url(${yt}) 1x,
      url(${Dt}) 2x
    );
  }
`,zt=A.div`
  padding: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    display: flex;
    flex-direction: row;
  }
`,_t=A.div`
  padding: 24px 8px;
  box-shadow: 0px 4px 14px 0px rgba(64, 123, 255, 0.3);
  background: ${s=>s.theme.color.secondaryWhite};
  max-width: 280px;

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.tablet}) {
    padding: 32px 24px;
    max-width: 704px;
  }

  @media screen and (min-width: ${({theme:s})=>s.breakpoint.desktop}) {
    max-width: 592px;
    flex-direction: row;
  }
`,Xt=()=>e.jsx(Et,{children:e.jsxs(zt,{children:[e.jsxs("div",{children:[e.jsx(Rt,{}),e.jsx(At,{})]}),e.jsxs(_t,{children:[e.jsx(Ut,{}),e.jsx(Yt,{})]})]})});export{Xt as default};
