import{t as k,l as E,m as ee,o as te,p as T,q as ne,r as d,j as e,D as me,v as fe,w as ge,x as pe,y as je,z as ye,A as De,E as O,F as Me,G as R,g as L,J as se,K as ae,M as we,N as Se,Q as ke,R as z,S as re,U as Te,V as Ce,X as oe,Y as p,Z as be,_ as ve,$ as Ne,a0 as _,a1 as He,a2 as $e,a3 as We,a4 as Ie,a5 as Oe,a6 as Be,a7 as ie,s as S,a8 as le,a9 as ce,aa as Pe,ab as G,ac as Z,ad as K,ae as Le,af as Re,ag as Ve,ah as Fe,ai as Ue,aj as Ye,ak as Ae,al as Ee,am as ze,an as _e,ao as X,ap as Ge,aq as Ze,ar as Ke,as as Xe,at as qe,au as Je,av as Qe,aw as et,ax as tt,ay as nt,az as st,aA as at,aB as rt,aC as ot,aD as it,aE as lt,aF as ct,aG as dt,aH as ut,n as U}from"./index-71917106.js";import{S as ht}from"./Section-670d2c77.js";import{i as xt,a as mt,b as ft,c as gt,d as pt,e as jt}from"./bubbleTablet@2x-6c947164.js";function de(n,t){const s=k(n);if(isNaN(t))return E(n,NaN);if(!t)return s;const a=s.getDate(),r=E(n,s.getTime());r.setMonth(s.getMonth()+t+1,0);const i=r.getDate();return a>=i?r:(s.setFullYear(r.getFullYear(),r.getMonth(),a),s)}function q(n){const t=k(n),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}function yt(n,t){const s=k(n.start),a=k(n.end);let r=+s>+a;const i=r?+s:+a,o=r?a:s;o.setHours(0,0,0,0);let l=(t==null?void 0:t.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(k(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return r?c.reverse():c}function J(n){const t=k(n);return t.setDate(1),t.setHours(0,0,0,0),t}function Q(n,t){const s=k(n),a=k(t);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}function F(n,t){const s=(t==null?void 0:t.additionalDigits)??2,a=St(n);let r;if(a.date){const c=kt(a.date,s);r=Tt(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const i=r.getTime();let o=0,l;if(a.time&&(o=Ct(a.time),isNaN(o)))return new Date(NaN);if(a.timezone){if(l=bt(a.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),x=new Date(0);return x.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),x.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),x}return new Date(i+o+l)}const B={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Dt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Mt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,wt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function St(n){const t={},s=n.split(B.dateTimeDelimiter);let a;if(s.length>2)return t;if(/:/.test(s[0])?a=s[0]:(t.date=s[0],a=s[1],B.timeZoneDelimiter.test(t.date)&&(t.date=n.split(B.timeZoneDelimiter)[0],a=n.substr(t.date.length,n.length))),a){const r=B.timezone.exec(a);r?(t.time=a.replace(r[1],""),t.timezone=r[1]):t.time=a}return t}function kt(n,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=n.match(s);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:i===null?r:i*100,restDateString:n.slice((a[1]||a[2]).length)}}function Tt(n,t){if(t===null)return new Date(NaN);const s=n.match(Dt);if(!s)return new Date(NaN);const a=!!s[4],r=$(s[1]),i=$(s[2])-1,o=$(s[3]),l=$(s[4]),c=$(s[5])-1;if(a)return Wt(t,l,c)?vt(t,l,c):new Date(NaN);{const x=new Date(0);return!Ht(t,i,o)||!$t(t,r)?new Date(NaN):(x.setUTCFullYear(t,i,Math.max(r,o)),x)}}function $(n){return n?parseInt(n):1}function Ct(n){const t=n.match(Mt);if(!t)return NaN;const s=V(t[1]),a=V(t[2]),r=V(t[3]);return It(s,a,r)?s*ee+a*te+r*1e3:NaN}function V(n){return n&&parseFloat(n.replace(",","."))||0}function bt(n){if(n==="Z")return 0;const t=n.match(wt);if(!t)return 0;const s=t[1]==="+"?-1:1,a=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Ot(a,r)?s*(a*ee+r*te):NaN}function vt(n,t,s){const a=new Date(0);a.setUTCFullYear(n,0,4);const r=a.getUTCDay()||7,i=(t-1)*7+s+1-r;return a.setUTCDate(a.getUTCDate()+i),a}const Nt=[31,null,31,30,31,30,31,31,30,31,30,31];function ue(n){return n%400===0||n%4===0&&n%100!==0}function Ht(n,t,s){return t>=0&&t<=11&&s>=1&&s<=(Nt[t]||(ue(n)?29:28))}function $t(n,t){return t>=1&&t<=(ue(n)?366:365)}function Wt(n,t,s){return t>=1&&t<=53&&s>=0&&s<=6}function It(n,t,s){return n===24?t===0&&s===0:s>=0&&s<60&&t>=0&&t<60&&n>=0&&n<25}function Ot(n,t){return t>=0&&t<=59}function Bt(n,t){return de(n,-t)}const Pt=()=>{const{waterRate:n}=T(ne),[t,s]=d.useState(!1),a=()=>{s(!0)},r=()=>{s(!1)},i=(n/1e3).toFixed(1)+" L";return e.jsxs(me,{children:[e.jsxs(fe,{children:[e.jsx("h2",{children:"My daily norma: "}),e.jsxs("div",{children:[e.jsx("p",{children:i}),e.jsx("button",{onClick:a,children:"Edit"})]}),e.jsx(ge,{onClose:r,onShow:t})]}),e.jsx(pe,{})]})},Lt=({stats:n,position:t,onShow:s})=>{const{date:a,drinkCount:r,waterVolumePercentage:i}=n,o=d.useRef(null),{waterRate:l}=T(ne);d.useEffect(()=>{if(!o.current)return;const{top:g,left:j,width:m}=t,h=o.current,w=h.offsetWidth;if(window.innerWidth<=320)h.style.width="100%",h.style.left="0",h.style.top=`${g-h.offsetHeight}px`,h.style.transform="translateX(0)";else{const C=j,b=window.innerWidth-j-m;C>w?h.style.left=`${j-w}px`:b>w?h.style.left=`${j+m}px`:(h.style.left="50%",h.style.transform="translateX(-50%)"),h.style.top=`${g-h.offsetHeight}px`}},[t]);const c=(l/1e3).toFixed(1)+" L",x=a?je(a,"d, MMMM"):"";return e.jsx(ye,{ref:o,style:{visibility:s?"visible":"hidden"},children:e.jsxs(De,{children:[e.jsx(O,{children:e.jsx(Me,{children:x})}),e.jsxs(O,{children:["Daily norma:",e.jsx(R,{children:c})]}),e.jsxs(O,{children:["Fulfillment of the daily norm:",e.jsxs(R,{children:[Math.round(i),"%"]})]}),e.jsxs(O,{children:["How many servings of water:",e.jsx(R,{children:r})]})]})})},Rt=({onClose:n,onShow:t,recordId:s})=>{const a=L(),{isLoading:r}=T(se),i="32px 24px",o=()=>{a(Te(s)).then(l=>{l.error||n()})};return e.jsx(ae,{onClose:n,onShow:t,stylesPadding:i,title:"Delete Entry",children:e.jsxs(we,{children:[e.jsx(Se,{children:"Are you sure you want to delete the entry?"}),e.jsxs(ke,{children:[e.jsxs(z,{onClick:o,children:["Delete ",r&&e.jsx(re,{})]}),e.jsx(z,{onClick:n,children:"Cancel"})]})]})})},Vt=()=>{const n=L(),t=T(Ce),[s,a]=d.useState(new Date),[r,i]=d.useState(null),[o,l]=d.useState(!1),[c,x]=d.useState({top:0,left:0,width:0}),[g,j]=d.useState(null),[m,h]=d.useState(!1),w=d.useRef({}),W=T(oe),C=p(J(s),"yyyy-MM-dd"),b=p(q(s),"yyyy-MM-dd");d.useEffect(()=>{n(be({startDate:C,endDate:b}))},[n,b,W,C]);const f=()=>{const u=Bt(s,1);a(u),Q(u,new Date)?i(null):i("prev")},M=()=>{if(s<new Date){const u=de(s,1);a(u),Q(u,new Date)?i(null):i("next")}},v=yt({start:J(s),end:q(s)}),Y=t.reduce((u,D)=>(u[D.date]=D,u),{}),xe=u=>{const D=p(u,"yyyy-MM-dd"),y=Y[D];(g==null?void 0:g.date)===D&&o?(l(!1),j(null)):(j({date:D,waterVolumeSum:y?y.waterVolumeSum:0,drinkCount:y?y.drinkCount:0,waterVolumePercentage:y?y.waterVolumePercentage:0}),l(!0));const I=w.current[u];if(I){const H=I.getBoundingClientRect();x({top:H.top+window.scrollY,left:H.left,width:H.width})}},A=()=>{l(!1),j(null)};return d.useEffect(()=>{const u=D=>{o&&Object.values(w.current).every(N=>N&&!N.contains(D.target))&&A()};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[o,g]),e.jsxs("div",{children:[e.jsxs(ve,{children:[e.jsx("h2",{children:"Month"}),e.jsxs(Ne,{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[e.jsx(_,{onClick:f,active:r==="next",children:"<"}),e.jsx("span",{children:p(s,"MMMM")}),m&&e.jsx(He,{children:p(s,"yyyy").split("-")[0]}),e.jsx(_,{onClick:M,disabled:s>=new Date,active:r==="prev",children:">"})]})]}),e.jsxs($e,{children:[v.map(u=>{const D=p(u,"yyyy-MM-dd"),y=Y[D],N=y?y.waterVolumePercentage:0,I=y&&y.waterVolumePercentage<100;return e.jsx("div",{children:e.jsxs(We,{children:[e.jsx(Ie,{ref:H=>w.current[u]=H,onClick:()=>xe(u),isHighlighted:I,children:p(u,"d")}),e.jsxs("span",{children:[Math.round(N),"%"]})]})},D)}),o&&g&&e.jsx(Lt,{stats:g,position:c,onClose:A,onShow:o})]})]})},he=({initialAmount:n,initialTime:t,isEditing:s,onClose:a,onShow:r,existingRecordId:i})=>{const[o,l]=d.useState(n||0),[c,x]=d.useState(s&&t?p(new Date(t),"HH:mm"):p(new Date,"HH:mm")),g=L(),{isLoading:j}=T(se),m=()=>l(f=>f+50),h=()=>l(f=>f>0?f-50:0),w=f=>{let M=f.target.value;M.startsWith("0")&&M.length>1&&(M=M.substring(1)),l(M)};d.useEffect(()=>{s?(l(n||0),x(t?p(F(t),"HH:mm"):p(new Date,"HH:mm"))):(l(0),x(p(new Date,"HH:mm")))},[s,n,t]);const W=()=>{let f;s?f=t?new Date(t).toISOString():new Date().toISOString():f=new Date().toISOString();const M={waterVolume:o,date:f};s?g(Ee({_id:i,...M})).then(v=>{v.error||a()}):g(ze(M)).then(v=>{v.error||a()})},C=s?"Edit the entered amount of water":"Add water",b=s&&t?p(F(t),"hh:mm aa"):"";return e.jsx(ae,{onClose:a,onShow:r,title:C,children:e.jsxs(Oe,{children:[s&&e.jsxs(Be,{children:[e.jsx(ie,{children:e.jsx("use",{href:`${S}#icon-glass`})}),e.jsx(le,{children:n?`${n} ml`:"No notes yet"}),e.jsx(ce,{children:t?`${b}`:""})]}),e.jsx("h3",{children:s?"Correct entered data:":"Choose a value:"}),e.jsxs(Pe,{children:[e.jsx(G,{children:"Amount of water:"}),e.jsxs("div",{children:[e.jsx(Z,{onClick:h,children:e.jsx(K,{children:e.jsx("use",{href:`${S}#icon-decrement-outline`})})}),e.jsx(Le,{children:e.jsxs(Re,{children:[o," ml"]})}),e.jsx(Z,{onClick:m,children:e.jsx(K,{children:e.jsx("use",{href:`${S}#icon-increment`})})})]})]}),e.jsxs(Ve,{children:[e.jsx(G,{children:"Recording time:"}),e.jsx(Fe,{type:"time",value:c,onChange:f=>x(f.target.value),step:"300"})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Enter the value of the water used:"}),e.jsx(Ue,{type:"number",value:o,onChange:w,onBlur:()=>l(f=>f||n||"")})]}),e.jsxs(Ye,{children:[e.jsxs("span",{children:[o,"ml"]}),e.jsxs(Ae,{onClick:W,children:["Save ",j&&e.jsx(re,{})]})]})]})})},P={glass:`${S}#icon-glass`,change:`${S}#icon-change`,delete:`${S}#icon-delete`,add:`${S}#icon-increment`},Ft=()=>{const n=L(),[t,s]=d.useState(!1),[a,r]=d.useState(null),[i,o]=d.useState(!1),{dailyWaterList:l}=T(_e);d.useEffect(()=>{n(X())},[n]);const c=()=>{r(null),s(!0)},x=m=>{r(m),o(!0)},g=m=>{r(m),s(!0)},j=()=>{n(X())};return e.jsxs(Ge,{children:[e.jsx(Ze,{children:"Today"}),e.jsxs(Ke,{children:[l==null?void 0:l.map(m=>e.jsxs(Xe,{children:[e.jsxs(qe,{children:[e.jsx(ie,{children:e.jsx("use",{href:P.glass})}),e.jsxs(le,{children:[m.waterVolume," ml"]}),e.jsx(ce,{children:p(F(m.date),"hh:mm a")})]}),e.jsxs(Je,{children:[e.jsx(Qe,{onClick:()=>g(m),children:e.jsx("svg",{children:e.jsx("use",{href:P.change})})}),e.jsx(et,{onClick:()=>x(m),children:e.jsx("svg",{children:e.jsx("use",{href:P.delete})})})]})]},m._id)),e.jsx("li",{children:e.jsxs(tt,{onClick:c,children:[e.jsx("svg",{children:e.jsx("use",{href:P.add})}),"Add Water"]})})]}),e.jsx(Rt,{onClose:()=>o(!1),onShow:i,recordId:a==null?void 0:a._id}),e.jsx(he,{initialAmount:a==null?void 0:a.waterVolume,initialTime:a==null?void 0:a.date,isEditing:a!==null,existingRecordId:a==null?void 0:a._id,onClose:()=>s(!1),onShow:t,onUpdate:j})]})},Ut=()=>{const[n,t]=d.useState(!1),s=T(oe),a=()=>({left:`calc(${Math.min(100,Math.max(0,s))}% + 4px)`}),r=()=>({backgroundSize:`${s}%`}),i=s>0&&s<100;return e.jsxs(nt,{children:[e.jsxs(st,{children:[e.jsx(at,{children:"Today"}),e.jsx(rt,{type:"range",maxValue:100,minValue:0,value:s,readOnly:!0,style:r(),"aria-label":"Water range"}),e.jsxs(ot,{children:[e.jsx(it,{children:"0%"}),i&&e.jsx(lt,{id:"waterMark",style:a(),children:`${s}%`}),e.jsx(ct,{children:"100%"})]})]}),e.jsxs(dt,{onClick:()=>t(!0),children:[e.jsx(ut,{children:e.jsx("use",{href:`${S}#icon-increment-outline`})}),"Add Water"]}),e.jsx(he,{onClose:()=>t(!1),onShow:n})]})},Yt=U(ht)`
  background-position: center center;
  padding-top: 24px;
  padding-bottom: 24px;
  background-image: -webkit-image-set(
    url(${xt}) 1x,
    url(${mt}) 2x
  );
  background-size: contain;
  background-repeat: no-repeat;
  width: 100%;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.tablet}) {
    background-image: -webkit-image-set(
      url(${ft}) 1x,
      url(${gt}) 2x
    );
  }

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    background-image: -webkit-image-set(
      url(${pt}) 1x,
      url(${jt}) 2x
    );
  }
`,At=U.div`
  padding: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    display: flex;
    flex-direction: row;
  }
`,Et=U.div`
  padding: 24px 8px;
  box-shadow: 0px 4px 14px 0px rgba(64, 123, 255, 0.3);
  background: ${n=>n.theme.color.secondaryWhite};
  max-width: 280px;

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.tablet}) {
    padding: 32px 24px;
    max-width: 704px;
  }

  @media screen and (min-width: ${({theme:n})=>n.breakpoint.desktop}) {
    max-width: 592px;
    flex-direction: row;
  }
`,Zt=()=>e.jsx(Yt,{children:e.jsxs(At,{children:[e.jsxs("div",{children:[e.jsx(Pt,{}),e.jsx(Ut,{})]}),e.jsxs(Et,{children:[e.jsx(Ft,{}),e.jsx(Vt,{})]})]})});export{Zt as default};
